<div class="wizard-container">
  <!-- Progress Bar -->
  <mat-progress-bar 
    mode="determinate" 
    [value]="(currentStep / totalSteps) * 100" 
    class="progress-bar">
  </mat-progress-bar>
  <p class="step-indicator">{{ 'WIZARD.PROGRESS' | translate : { step: currentStep, total: totalSteps } }}</p>

  <!-- Step Headings -->
  <h1 *ngIf="currentStep === 1" class="step-heading">Step 1: Personal Information</h1>
  <h1 *ngIf="currentStep === 2" class="step-heading">Step 2: Family & Financial Information</h1>
  <h1 *ngIf="currentStep === 3" class="step-heading">Step 3: Situation Descriptions</h1>

  <!-- ================= Step 1: Personal Info ================= -->
  <app-personal-info
    *ngIf="currentStep === 1"
    [form1]="form1"
    [countries]="countries"
    [selectedCountryCode]="selectedCountryCode"
    [getCountryTranslationKey]="getCountryTranslationKey.bind(this)"
    [isStepValid]="isStepValid.bind(this)"
    [countryChange]="onCountryChange.bind(this)"
  ></app-personal-info>

  <!-- ================= Step 2: Family & Financial Info ================= -->
  <app-family-financial-info
    *ngIf="currentStep === 2"
    [form2]="form2"
    [employmentOptions]="employmentOptions"
    [getEmploymentTranslationKey]="getEmploymentTranslationKey.bind(this)"
    [isStepValid]="isStepValid.bind(this)"
  ></app-family-financial-info>

  <!-- ================= Step 3: Situation Descriptions ================= -->
  <app-situation-descriptions
    *ngIf="currentStep === 3"
    [form3]="form3"
    [isStepValid]="isStepValid.bind(this)"
    (helpMeWrite)="openHelp($event)"
  ></app-situation-descriptions>

  <!-- ================= Navigation Buttons ================= -->
  <div class="nav-buttons">
    <button mat-button type="button" (click)="prevStep()" [disabled]="currentStep === 1">
      {{ 'BACK' | translate }}
    </button>
    
    <button 
      mat-raised-button 
      color="primary" 
      type="button" 
      *ngIf="currentStep < totalSteps" 
      (click)="nextStep()" 
      [disabled]="!isStepValid()">
      {{ 'NEXT' | translate }}
    </button>
    
    <button 
      mat-raised-button 
      color="accent" 
      type="button" 
      *ngIf="currentStep === totalSteps" 
      (click)="onSubmit()" 
      [disabled]="!isStepValid()">
      {{ 'SUBMIT' | translate }}
    </button>
  </div>
</div>